<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Herrera Motors</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-white text-black">
  <!-- Navbar -->
  <nav class="flex items-center justify-between px-6 py-4 border-b">
    <div class="text-xl font-semibold tracking-widest">HERRERA MOTORS</div>
    <div class="hidden md:flex gap-8 text-sm">
      <a href="#" class="hover:underline">Sobre</a>
      <a href="#" class="hover:underline">Experiência AG</a>
      <a href="#" class="hover:underline">Veículos</a>
      <a href="#" class="hover:underline">Blog</a>
      <a href="#" class="hover:underline">Universo AG</a>
      <a href="#" class="hover:underline">Contato</a>
    </div>
  </nav>

  <!-- Filtros -->
  <section class="flex flex-col items-center px-4 py-8">
    <h2 class="text-xl font-semibold mb-6">Encontre seu próximo veículo</h2>
    <div class="w-full max-w-5xl flex flex-col md:flex-row justify-center gap-4">
      <select id="marcaSelect" class="border-b-2 border-orange-500 px-2 py-1 w-full md:w-1/3">
        <option value="">Selecione a marca</option>
      </select>
      <select id="modeloSelect" class="border-b-2 border-orange-500 px-2 py-1 w-full md:w-1/3">
        <option value="">Selecione o modelo</option>
      </select>
      <button id="btnBuscar" class="bg-orange-600 text-white px-6 py-2 font-bold hover:bg-orange-700 rounded">
        BUSCAR
      </button>
    </div>
  </section>

  <!-- Lista de veículos -->
  <section id="listaVeiculos" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 px-4 pb-12 max-w-6xl mx-auto"></section>

  <!-- Script -->
<script>
  document.addEventListener("DOMContentLoaded", async () => {
    const marcaSelect = document.getElementById("marcaSelect");
    const modeloSelect = document.getElementById("modeloSelect");

    const res = await fetch(
      "https://roanjrdmydpvbpryiegg.supabase.co/rest/v1/ESTOQUE?select=*",
      {
        headers: {
          apikey: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
        },
      }
    );
    const estoque = await res.json();

    const marcasUnicas = [...new Set(estoque.map((v) => v.modelo.split(" ")[0]))];
    marcasUnicas.sort().forEach((marca) => {
      const opt = document.createElement("option");
      opt.value = marca;
      opt.textContent = marca;
      marcaSelect.appendChild(opt);
    });

    marcaSelect.addEventListener("change", () => {
      const marcaSelecionada = marcaSelect.value;
      modeloSelect.innerHTML = '<option value="">Selecione o modelo</option>';
      estoque
        .filter((v) => v.modelo.startsWith(marcaSelecionada))
        .forEach((v) => {
          const opt = document.createElement("option");
          opt.value = v.modelo;
          opt.textContent = v.modelo;
          modeloSelect.appendChild(opt);
        });
    });

    document.getElementById("btnBuscar").addEventListener("click", () => {
      const modelo = modeloSelect.value;
      if (modelo) {
        window.location.href = `/veiculo.html?modelo=${encodeURIComponent(modelo)}`;
      }
    });
  });
</script>
</body>
</html>
